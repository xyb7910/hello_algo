# 【基础训练营-10 月月考】蘑菇药剂

## 题目描述

小 A 又双叒叕使用蘑菇进行炼金，他想要炼制一管富含魔力的魔法药剂。

现在他获得了 $n$ 个蘑菇，第 $i$ 个蘑菇有一个魔力值 $t_i$。当使用两个蘑菇 $(i,j)$ 进行炼制时，其会发生魔力反应，其产生的效果值为 $f(i,j)$。$f(i,j)$ 被如下定义：

若第 $i$ 个蘑菇的魔法值 $t_i$ 被拆成形如 $\overline{a_1a_2a_3\dots a_p}$ 的 $p$ 个数位，第 $j$ 个蘑菇的魔法值 $t_j$ 被拆成形如 $\overline{b_1b_2b_3\dots b_q}$ 的 $q$ 个数位，则有：

$$f(i,j)=\begin{cases}\overline{a_1a_2\dots a_{p-q+1}b_1a_{p-q}b_2\dots a_pb_q}& p \geq q\\\overline{b_1b_2\dots b_{q-p}a_1b_{q-p+1}a_2b_{q-p+2}\dots a_pb_q} & p<q\end{cases}$$

例如，$f(33,4444)=443434$，$f(6666,888)=6686868$。

而当所有的蘑菇都被投入炼制的时候，每两个蘑菇之间都会发生魔力反应，而且一对蘑菇 $(i,j)$ 会反应两次，一次产生 $f(i,j)$ 的效果值，一次产生 $f(j,i)$ 的效果值。

此外，第 $i$ 个蘑菇自身也会产生 $f(i,i)$ 个效果值（而非 $t_i$）。换而言之，其会产生的总共效果值：

$$\sum_{i=1}^n \sum_{j=1}^n f(i,j)$$

现在你需要帮小 A 求出这些蘑菇能够造成的总效果值。为了方便起见，你只需要输出答案 $\bmod 998244353$ 的结果。

## 输入格式

第一行输入一个正整数 $n$，表示蘑菇个数。

第二行输入 $n$ 个正整数 $t_i$。

## 输出格式

输出一行，表示 $\sum \limits_{i=1}^n \sum \limits_{j=1}^n f(i,j) \bmod 998244353$ 的值。

## 样例 #1

### 样例输入 #1

```
4
12 34 56 78
```

### 样例输出 #1

```
71280
```

## 提示

**【样例解释】**

结果为：$f(1,1)+f(1,2)+f(1,3)+f(1,4)+f(2,1)+f(2,2)+f(2,3)+f(2,4)$ $+f(3,1)+f(3,2)+f(3,3)+f(3,4)+f(4,1)+f(4,2)+f(4,3)+f(4,4)=71280$。

**【数据范围】**

对于 $30\%$ 的数据，$n \leq 1000$；

另有 $30\%$ 的数据，所有 $a_i$ 的数字位数均相等。

对于所有数据，$1 \leq n \leq 5\times 10^5$，$1 \leq a_i \leq 10^9$。