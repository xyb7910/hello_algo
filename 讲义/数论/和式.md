### 数学中的和式讲义

#### 一、和式的定义

和式（Summation）是数学中表示多个数相加的一种简洁表示方法，通常用希腊字母Σ（西格玛）表示。给定一个数列a₁, a₂, ..., aₙ，其前n项的和可以表示为：

$
\sum_{k=1}^{n} a_k = a_1 + a_2 + \cdots + a_n
$

其中，k称为求和指标，1是下限，n是上限，a_k是求和项。求和指标的符号可以任意选择，例如：

$
\sum_{i=1}^{n} a_i = \sum_{j=1}^{n} a_j = \sum_{k=1}^{n} a_k
$

#### 二、和式的常见性质

1. **常数因子提取**：
   $
   \sum_{k=1}^{n} c \cdot a_k = c \cdot \sum_{k=1}^{n} a_k
   $
   其中c是常数。

2. **和的分配律**：
   $
   \sum_{k=1}^{n} (a_k + b_k) = \sum_{k=1}^{n} a_k + \sum_{k=1}^{n} b_k
   $

3. **上下限变化**：
   $
   \sum_{k=1}^{n} a_k = \sum_{k=0}^{n-1} a_{k+1}
   $

4. **分段求和**：
   $
   \sum_{k=1}^{n} a_k = \sum_{k=1}^{m} a_k + \sum_{k=m+1}^{n} a_k \quad (1 \leq m < n)
   $

#### 三、计算公式推导

1. **等差数列求和公式**：
   对于等差数列a_k = a₁ + (k-1)d，其前n项和为：
   $$
   
   \begin{align}
   S_n = \sum_{k=1}^{n} [a_1 + (k-1)d] 
   \\= \frac{n}{2} [2a_1 + (n-1)d] 
   \\= \frac{n(a_1 + a_n)}{2}
   \end{align}
 
   $$

   **推导过程**：
   $$
   S_n = a_1 + (a_1 + d) + (a_1 + 2d) + \cdots \\+ [a_1 + (n-1)d]
   $$

   倒序书写：
   $$
   S_n = [a_1 + (n-1)d] + [a_1 + (n-2)d] + \cdots \\+ a_1
   $$
   两式相加：

   $$
   2S_n = n[2a_1 + (n-1)d] \implies \\S_n = \frac{n}{2} [2a_1 + (n-1)d]
   $$

2. **等比数列求和公式**：
   对于等比数列$a_k = a₁·r^(k-1)$，其前n项和为：
   $$
   S_n = \sum_{k=1}^{n} a_1 \cdot r^{k-1} = a_1 \cdot \frac{r^n - 1}{r - 1} \quad (r \neq 1)
   $$

   **推导过程**：
   
   $$
   S_n = a_1 + a_1r + a_1r^2 + \cdots + a_1r^{n-1}
   $$

   两边乘以r：
   
   $$
   rS_n = a_1r + a_1r^2 + \cdots \\+ a_1r^{n-1} + a_1r^n
   $$

   两式相减：
   $$
   S_n - rS_n = a_1 - a_1r^n \implies \\S_n(1 - r) = a_1(1 - r^n) \implies \\S_n = a_1 \cdot \frac{r^n - 1}{r - 1}
   $$

3. **自然数平方和公式**：
   $$
   \sum_{k=1}^{n} k^2 = \frac{n(n+1)(2n+1)}{6}
   $$

   **推导过程**：

   利用立方差公式：
   $$
   (k+1)^3 - k^3 = 3k^2 + 3k + 1
   $$

   对k从1到n求和：
   $$
   \sum_{k=1}^{n} [(k+1)^3 - k^3] = (n+1)^3 - 1^3
   $$

   左边为望远镜求和，结果为$(n+1)^3 - 1$。右边展开：
   $$
   \sum_{k=1}^{n} (3k^2 + 3k + 1) \\= 3\sum_{k=1}^{n} k^2 + 3\sum_{k=1}^{n} k + \sum_{k=1}^{n} 1
   $$

   代入已知公式：

   $$
   (n+1)^3 - 1 \\= 3\sum_{k=1}^{n} k^2 + 3\frac{n(n+1)}{2} + n
   $$

   解得：
   $$
   \sum_{k=1}^{n} k^2 = \frac{n(n+1)(2n+1)}{6}
   $$

#### 四、计算技巧

1. **换元法**：
   当求和指标的表达式较为复杂时，可以通过换元简化计算。
   
   例如：
   $
   \sum_{k=1}^{n} a_{2k} = \sum_{j=1}^{\lfloor n/2 \rfloor} a_{2j} \quad (j = 2k)
   $

2. **拆分法**：
   将复杂的求和项拆分为多个简单项的和。
   
   例如：
   $
   \sum_{k=1}^{n} (2k + 3k^2) = 2\sum_{k=1}^{n} k + 3\sum_{k=1}^{n} k^2
   $

3. **错位相减法**：
   适用于等差数列与等比数列乘积的求和。
   
   例如：
   $
   S_n = \sum_{k=1}^{n} k \cdot 2^k
   $
   两边乘以`2`，然后错位相减求解。

4. **数学归纳法**：
   用于证明和式公式的正确性。
   
   例如，证明自然数平方和公式：
   - **基础步骤**：当$n=1$时，左边=1，右边=1·2·3/6=1，成立。
   - **归纳步骤**：假设`n=m`时成立，证明`n=m+1`时也成立。

#### 五、常见公式的C++代码实现

#### 六、应用示例

1. **问题**：计算1到100之间所有奇数的和。
   **解答**：这是一个首项为1，公差为2，项数为50的等差数列。
   $
   S = \frac{50}{2} [2 \cdot 1 + (50 - 1) \cdot 2] = 2500
   $
   **验证**：
   $
   1 + 3 + 5 + \cdots + 99 = 2500
   $

2. **问题**：计算1² + 2² + 3² + ... + 10²。
   **解答**：直接应用自然数平方和公式：
   $
   S = \frac{10 \cdot 11 \cdot 21}{6} = 385
   $

#### 七、练习题

1. 计算1到1000之间所有能被3整除的数的和。
2. 计算等比数列2, 6, 18, ... 的前10项和。
3. 推导自然数四次方和公式：
   $
   \sum_{k=1}^{n} k^4 = \frac{n(n+1)(2n+1)(3n^2 + 3n - 1)}{30}
   $
4. 计算斐波那契数列前20项的和。

这份讲义涵盖了和式的基本概念、性质、推导方法、计算技巧以及C++代码实现。通过学习这些内容，学生应该能够理解和式的数学原理，并能够编写代码解决相关问题。